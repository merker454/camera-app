function cameraStart(){navigator.mediaDevices.getUserMedia(constraints).then(function(e){track=e.getTracks()[0],cameraView.srcObject=e}).catch(function(e){console.error("Oops. Something is broken.",e)})}var constraints={video:{facingMode:"user"},audio:!1},track=null;const cameraView=document.querySelector("#camera--view"),cameraOutput=document.querySelector("#camera--output"),cameraSensor=document.querySelector("#camera--sensor"),cameraTrigger=document.querySelector("#camera--trigger");cameraTrigger.onclick=function(){cameraSensor.width=cameraView.videoWidth,cameraSensor.height=cameraView.videoHeight,cameraSensor.getContext("2d").drawImage(cameraView,0,0),cameraOutput.src=cameraSensor.toDataURL("image/webp"),cameraOutput.classList.add("taken")},window.addEventListener("load",cameraStart,!1),"serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),navigator.serviceWorker.register("sw.js").then(function(){console.log("CLIENT: service worker registration complete.")},function(){console.log("CLIENT: service worker registration failure.")})):console.log("CLIENT: service worker is not supported.");
